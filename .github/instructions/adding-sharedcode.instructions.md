---
applyTo: "AIDevGallery/Samples/SharedCode/**/*.cs"
---

# SharedCode Instructions

When reviewing or modifying code in `AIDevGallery/Samples/SharedCode/`:

## Purpose

SharedCode contains reusable utilities that are:
1. Used by multiple samples within the app
2. **Exported** with samples when users generate standalone VS projects

Because SharedCode is exported, it has special requirements.

## Code Requirements

### Must Be Self-Contained
- Minimize dependencies on app-specific code
- Use only packages specified in sample's `NugetPackageReferences`
- Avoid references to `AIDevGallery.Pages`, `AIDevGallery.ViewModels`, etc.

### Must Be Exportable
- No internal app state dependencies
- No hardcoded paths to app resources
- Clear, documented public APIs

## SharedCodeEnum Auto-Generation

The `SharedCodeEnum` is auto-generated by the source generator from:
- Files in `AIDevGallery/Samples/SharedCode/` directory
- Special case: `AIDevGallery/Utils/DeviceUtils.cs`
- Special case: `NativeMethods.txt` (for P/Invoke definitions)

Generation rules:
- Each `.cs` file becomes an enum value
- XAML pairs (`.xaml` + `.xaml.cs`) get both `*Cs` and `*Xaml` values

Example: `BitmapFunctions.cs` â†’ `SharedCodeEnum.BitmapFunctions`

## Usage in Samples

Reference in `[GallerySample]` attribute:
```csharp
[GallerySample(
    SharedCode = [
        SharedCodeEnum.BitmapFunctions,
        SharedCodeEnum.ImageNetLabels,
        SharedCodeEnum.Prediction
    ],
    NugetPackageReferences = [
        "System.Drawing.Common"
    ],
    ...
)]
```

## Adding New SharedCode

1. Create file in appropriate subfolder
2. Ensure file is self-contained
3. Rebuild to generate new `SharedCodeEnum` value
4. Update samples that use the code
5. Document required NuGet packages

## Code Review Checks

- New SharedCode files follow naming conventions
- Required NuGet packages documented
- No app-specific dependencies
- Code compiles standalone (for export)
- Proper error handling for edge cases
- Comments explain non-obvious logic
- Matching `.xaml` files for any XAML controls
