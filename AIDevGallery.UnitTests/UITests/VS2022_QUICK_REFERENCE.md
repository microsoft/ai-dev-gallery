# Visual Studio 2022 快速參考 - FlaUI 測試

## 🚀 快速開始（3 步驟）

### 1️⃣ 部署應用
```
按 F5 → 等待應用啟動 → 關閉應用
```
✅ MSIX 包已自動部署

### 2️⃣ 打開 Test Explorer
```
按 Ctrl+E, T
```

### 3️⃣ 運行測試
```
搜索框輸入：TestCategory=Smoke
點擊：全部運行
```

---

## 📋 常用快捷鍵

| 操作 | 快捷鍵 |
|------|--------|
| 打開 Test Explorer | `Ctrl+E, T` |
| 重新生成解決方案 | `Ctrl+Shift+B` |
| 開始調試（部署+運行） | `F5` |
| 無調試啟動 | `Ctrl+F5` |
| 查看輸出窗口 | `Ctrl+W, O` |
| 停止調試 | `Shift+F5` |

---

## 🔧 Test Explorer 使用技巧

### 篩選測試

在搜索框輸入：

| 想要運行的測試 | 輸入 |
|---------------|------|
| 所有 UI 測試 | `TestCategory=UI` |
| 煙霧測試（快速） | `TestCategory=Smoke` |
| 示例測試 | `TestCategory=Sample` |
| 主窗口測試 | `MainWindowTests` |
| 特定測試方法 | `MainWindow_Launches` |

### 運行測試

- **運行所有篩選的測試**: 點擊綠色播放按鈕
- **運行單個測試**: 右鍵 → 運行
- **調試測試**: 右鍵 → 調試
- **重新運行失敗的測試**: 點擊紅色 X 按鈕

### 查看測試結果

- ✅ **綠色勾號** = 通過
- ❌ **紅色 X** = 失敗
- ⚠️ **黃色感嘆號** = 跳過/未決

點擊測試可以看到：
- 執行時間
- 錯誤消息
- 堆棧跟踪
- 控制台輸出

---

## 🎯 部署方法對比

| 方法 | 操作 | 速度 | 適用場景 |
|------|------|------|----------|
| **F5** | 按 F5 | ⚡⚡⚡ 最快 | 首選方法 |
| **右鍵部署** | 右鍵項目 → 部署 | ⚡⚡ 快 | F5 不可用時 |
| **菜單部署** | 生成 → 部署解決方案 | ⚡⚡ 快 | 需要部署多個項目 |
| **命令行** | `msbuild /t:Deploy` | ⚡ 較慢 | 自動化/CI |

---

## 🐛 快速故障排除

### 看不到測試？
```
1. Ctrl+Shift+B（重新生成）
2. Test Explorer → 點擊重新整理按鈕
3. 檢查輸出窗口是否有錯誤
```

### 測試報 COM 錯誤？
```
1. 按 F5 運行一次應用（自動部署）
2. 關閉應用
3. 重新運行測試
```

### 部署失敗？
```
1. 確保平台選擇 x64（不是 Any CPU）
2. 清理解決方案（生成 → 清理解決方案）
3. 重新生成（Ctrl+Shift+B）
4. 再次按 F5
```

### 測試超時？
```
1. 關閉所有 AIDevGallery 實例
2. 任務管理器 → 結束 AIDevGallery 進程
3. 重新運行測試
```

---

## 📊 查看測試輸出

### 方法 1：Test Explorer 詳細信息
1. 點擊測試名稱
2. 查看底部的 "測試詳細信息" 面板
3. 查看 "輸出" 選項卡

### 方法 2：輸出窗口
1. 視圖 → 輸出（Ctrl+W, O）
2. "顯示輸出來源" 選擇 "測試"
3. 查看所有 Console.WriteLine 輸出

### 方法 3：測試日誌文件
測試運行時會生成截圖：
```
AIDevGallery.UnitTests\bin\x64\Debug\Screenshots\
```

---

## ⚙️ 配置檢查清單

在運行測試前確保：

- [ ] 解決方案已打開
- [ ] 啟動項目設為 `AIDevGallery`
- [ ] 配置選擇 `Debug`
- [ ] 平台選擇 `x64`
- [ ] 已按 F5 運行過一次（部署 MSIX）
- [ ] 可以在開始菜單找到 "AI Dev Gallery Dev"

---

## 💡 專業提示

### 提示 1：使用測試播放列表
1. 在 Test Explorer 中選擇多個測試
2. 右鍵 → 添加到播放列表
3. 創建自定義測試集（如 "快速測試"、"完整測試"）

### 提示 2：持續運行模式
1. Test Explorer → 設置圖標
2. 啟用 "在生成後自動運行測試"
3. 每次修改代碼後自動運行測試

### 提示 3：並行運行測試
1. 工具 → 選項 → 測試
2. 設置 "處理器計數"
3. 加快測試執行速度
   - ⚠️ 注意：UI 測試可能不適合並行運行

### 提示 4：使用實時單元測試（企業版）
如果您使用 VS Enterprise：
1. 測試 → 實時單元測試 → 啟動
2. 代碼更改時自動運行相關測試
3. 在編輯器中看到實時測試結果

---

## 🔗 相關資源

- [完整集成指南](INTEGRATION_GUIDE.md)
- [MSIX 部署詳解](MSIX_DEPLOYMENT_REQUIRED.md)
- [測試使用指南](README.md)

---

**記住：先按 F5，再運行測試！** 🎯
