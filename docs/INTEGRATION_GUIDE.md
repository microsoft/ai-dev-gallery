# FlaUI 5.0.0 é›†æˆå¿«é€ŸæŒ‡å—

æœ¬æ–‡æª”è¨˜éŒ„äº†åœ¨ AI Dev Gallery é …ç›®ä¸­é›†æˆ FlaUI 5.0.0 çš„å®Œæ•´æ­¥é©Ÿã€‚

## å·²å®Œæˆçš„æ›´æ”¹

### 1. æ·»åŠ  NuGet åŒ…å¼•ç”¨

**æ–‡ä»¶**: `Directory.Packages.props`

æ·»åŠ äº†ä»¥ä¸‹åŒ…ï¼š
```xml
<!-- for UI Automation testing -->
<PackageVersion Include="FlaUI.UIA3" Version="5.0.0" />
```

### 2. æ›´æ–°æ¸¬è©¦é …ç›®

**æ–‡ä»¶**: `AIDevGallery.UnitTests\AIDevGallery.UnitTests.csproj`

æ·»åŠ äº†åŒ…å¼•ç”¨ï¼š
```xml
<PackageReference Include="FlaUI.UIA3" />
```

### 3. å‰µå»ºæ¸¬è©¦åŸºç¤æ¶æ§‹

å‰µå»ºäº†ä»¥ä¸‹æ–‡ä»¶ï¼š

#### `AIDevGallery.UnitTests\UITests\FlaUITestBase.cs`
- åŸºç¤æ¸¬è©¦é¡ï¼Œæä¾›æ‡‰ç”¨å•Ÿå‹•å’Œæ¸…ç†åŠŸèƒ½
- è‡ªå‹•æŸ¥æ‰¾å’Œå•Ÿå‹• AIDevGallery.exe
- æä¾›æˆªåœ–å’Œç­‰å¾…å…ƒç´ çš„è¼”åŠ©æ–¹æ³•
- è™•ç†æ¸¬è©¦å‰å¾Œçš„æ¸…ç†å·¥ä½œ

#### `AIDevGallery.UnitTests\UITests\MainWindowTests.cs`
- ä¸»çª—å£çš„åŸºæœ¬æ¸¬è©¦ç”¨ä¾‹
- æ¸¬è©¦æ‡‰ç”¨å•Ÿå‹•ã€çª—å£å¯è¦‹æ€§ã€å…ƒç´ æŸ¥æ‰¾ç­‰
- 7 å€‹æ¸¬è©¦æ–¹æ³•ç¤ºç¯„ä¸åŒçš„é©—è­‰å ´æ™¯

#### `AIDevGallery.UnitTests\UITests\BasicInteractionTests.cs`
- æ¼”ç¤º FlaUI API ä½¿ç”¨çš„ç¤ºä¾‹æ¸¬è©¦
- 7 å€‹æ¸¬è©¦æ–¹æ³•å±•ç¤ºå¦‚ä½•æŸ¥æ‰¾å’Œæ“ä½œ UI å…ƒç´ 
- é©åˆä½œç‚ºç·¨å¯«æ–°æ¸¬è©¦çš„åƒè€ƒ

### 4. æ›´æ–°æ–‡æª”

#### `docs\UI-Testing-Technology-Comparison.md`
- æ›´æ–° NuGet åŒ…ç‰ˆæœ¬ç‚º 5.0.0
- æ·»åŠ æœ¬é …ç›®ä¸­çš„ FlaUI æ¸¬è©¦èªªæ˜
- æ›´æ–°å¸¸è¦‹å•é¡Œå’Œè³‡æºéˆæ¥

#### `AIDevGallery.UnitTests\UITests\README.md`
- æ–°å»ºè©³ç´°çš„ä½¿ç”¨æŒ‡å—
- åŒ…å«å¿«é€Ÿé–‹å§‹ã€æ¸¬è©¦é¡èªªæ˜ã€ç·¨å¯«æ–°æ¸¬è©¦çš„æ¨¡æ¿
- æä¾›èª¿è©¦æŠ€å·§å’Œæœ€ä½³å¯¦è¸

## é …ç›®çµæ§‹

```
AI-Dev-Gallery/
â”œâ”€â”€ Directory.Packages.props                    # âœ… å·²æ›´æ–° - æ·»åŠ  FlaUI.UIA3 5.0.0
â”œâ”€â”€ AIDevGallery.UnitTests/
â”‚   â”œâ”€â”€ AIDevGallery.UnitTests.csproj          # âœ… å·²æ›´æ–° - å¼•ç”¨ FlaUI.UIA3
â”‚   â””â”€â”€ UITests/                                # âœ… æ–°å»ºæ–‡ä»¶å¤¾
â”‚       â”œâ”€â”€ FlaUITestBase.cs                   # âœ… æ–°å»º - åŸºç¤æ¸¬è©¦é¡
â”‚       â”œâ”€â”€ MainWindowTests.cs                 # âœ… æ–°å»º - ä¸»çª—å£æ¸¬è©¦
â”‚       â”œâ”€â”€ BasicInteractionTests.cs           # âœ… æ–°å»º - ç¤ºä¾‹æ¸¬è©¦
â”‚       â””â”€â”€ README.md                          # âœ… æ–°å»º - ä½¿ç”¨æŒ‡å—
â””â”€â”€ docs/
    â””â”€â”€ UI-Testing-Technology-Comparison.md    # âœ… å·²æ›´æ–° - æ·»åŠ  FlaUI ä¿¡æ¯
```

## å¿«é€Ÿå…¥é–€ï¼ˆVisual Studio 2022ï¼‰

æœ€ç°¡å–®çš„æ–¹å¼æ˜¯ä½¿ç”¨ Visual Studio 2022ï¼š

### ğŸš€ ä¸‰æ­¥å®Œæˆ

1. **æ‰“é–‹è§£æ±ºæ–¹æ¡ˆ**
   - é›™æ“Š `AIDevGallery.sln` æˆ–åœ¨ VS ä¸­æ‰“é–‹

2. **æŒ‰ F5 é‹è¡Œæ‡‰ç”¨**ï¼ˆæœƒè‡ªå‹•éƒ¨ç½²ï¼‰
   - ç¢ºä¿å•Ÿå‹•é …ç›®æ˜¯ `AIDevGallery`
   - é…ç½®é¸æ“‡ `Debug`ï¼Œå¹³å°é¸æ“‡ `x64`
   - æŒ‰ `F5` æˆ–é»æ“Š "é–‹å§‹èª¿è©¦"
   - æ‡‰ç”¨å•Ÿå‹•å¾Œå¯ä»¥é—œé–‰ï¼ˆéƒ¨ç½²å·²å®Œæˆï¼‰

3. **é‹è¡Œæ¸¬è©¦**
   - æŒ‰ `Ctrl+E, T` æ‰“é–‹ Test Explorer
   - åœ¨æœç´¢æ¡†è¼¸å…¥ `TestCategory=Smoke`
   - é»æ“Š "å…¨éƒ¨é‹è¡Œ"

âœ… å®Œæˆï¼

---

## è©³ç´°æ­¥é©Ÿ

### âš ï¸ é‡è¦ï¼šWinUI3 æ¸¬è©¦éœ€è¦ MSIX éƒ¨ç½²

UI æ¸¬è©¦éœ€è¦å•Ÿå‹•å¯¦éš›çš„ AIDevGallery æ‡‰ç”¨ç¨‹åºã€‚ç”±æ–¼é€™æ˜¯ WinUI3 æ‡‰ç”¨ï¼Œå®ƒä¾è³´ Windows App SDK çš„ COM çµ„ä»¶ï¼Œå¿…é ˆé€šé MSIX æ‰“åŒ…éƒ¨ç½²æ‰èƒ½æ­£ç¢ºé‹è¡Œã€‚

### æ­¥é©Ÿ 1: éƒ¨ç½² MSIX åŒ…ï¼ˆå¿…éœ€ï¼ï¼‰

**æ–¹æ³• Aï¼šä½¿ç”¨ Visual Studio 2022ï¼ˆæœ€ç°¡å–®ï¼æ¨è–¦ï¼‰**

#### é¸é … 1ï¼šä½¿ç”¨éƒ¨ç½²å‘½ä»¤ï¼ˆæ¨è–¦ï¼‰

1. åœ¨ Visual Studio 2022 ä¸­æ‰“é–‹ `AIDevGallery.sln`
2. åœ¨**è§£æ±ºæ–¹æ¡ˆè³‡æºç®¡ç†å™¨**ä¸­ï¼Œæ‰¾åˆ° `AIDevGallery` é …ç›®
3. **å³éµé»æ“Š** `AIDevGallery` é …ç›®
4. é¸æ“‡ **"éƒ¨ç½²"ï¼ˆDeployï¼‰**
5. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸ 10-30 ç§’ï¼‰
6. çœ‹åˆ°è¼¸å‡ºçª—å£é¡¯ç¤º "éƒ¨ç½²æˆåŠŸ" æˆ– "Deploy succeeded"

![éƒ¨ç½²èœå–®](https://user-images.githubusercontent.com/placeholder-deploy-menu.png)

#### é¸é … 2ï¼šç›´æ¥æŒ‰ F5 é‹è¡Œï¼ˆæœ€å¿«ï¼‰

1. åœ¨ Visual Studio 2022 ä¸­æ‰“é–‹ `AIDevGallery.sln`
2. ç¢ºä¿å•Ÿå‹•é …ç›®è¨­ç½®ç‚º `AIDevGallery`
3. é¸æ“‡ **Debug** é…ç½®å’Œ **x64** å¹³å°
4. æŒ‰ **F5** æˆ–é»æ“Š **"é–‹å§‹èª¿è©¦"**
5. æ‡‰ç”¨æœƒè‡ªå‹•éƒ¨ç½²ä¸¦å•Ÿå‹•
6. é—œé–‰æ‡‰ç”¨ï¼ˆéƒ¨ç½²å·²å®Œæˆï¼‰

#### é¸é … 3ï¼šä½¿ç”¨ç”Ÿæˆèœå–®

1. åœ¨ Visual Studio ä¸­æ‰“é–‹è§£æ±ºæ–¹æ¡ˆ
2. é ‚éƒ¨èœå–®ï¼š**ç”Ÿæˆï¼ˆBuildï¼‰** â†’ **éƒ¨ç½²è§£æ±ºæ–¹æ¡ˆï¼ˆDeploy Solutionï¼‰**
3. æˆ–è€…åªéƒ¨ç½²ä¸€å€‹é …ç›®ï¼šå³éµé»æ“Šé …ç›® â†’ **éƒ¨ç½²**

**æ–¹æ³• Bï¼šä½¿ç”¨ MSBuildï¼ˆå‘½ä»¤è¡Œï¼‰**

å¦‚æœ Visual Studio éƒ¨ç½²å¤±æ•—ï¼Œå¯ä»¥å˜—è©¦å‘½ä»¤è¡Œï¼š

```powershell
# å¾è§£æ±ºæ–¹æ¡ˆæ ¹ç›®éŒ„é‹è¡Œ
msbuild AIDevGallery\AIDevGallery.csproj /t:Build,Deploy /p:Configuration=Debug /p:Platform=x64
```

**é©—è­‰éƒ¨ç½²æˆåŠŸï¼š**

æœ‰ä¸‰ç¨®æ–¹å¼é©—è­‰ï¼š

**æ–¹å¼ 1ï¼šæª¢æŸ¥ Visual Studio è¼¸å‡ºçª—å£**
- åœ¨ VS è¼¸å‡ºçª—å£ä¸­æ‡‰è©²çœ‹åˆ°ï¼š
  ```
  Deploy succeeded.
  ========== Deploy: 1 succeeded, 0 failed, 0 skipped ==========
  ```

**æ–¹å¼ 2ï¼šå¾é–‹å§‹èœå–®å•Ÿå‹•**
- æŒ‰ Windows éµ
- æœç´¢ "AI Dev Gallery Dev"
- å¦‚æœèƒ½æ‰¾åˆ°ä¸¦å•Ÿå‹•ï¼Œèªªæ˜éƒ¨ç½²æˆåŠŸ âœ…

**æ–¹å¼ 3ï¼šä½¿ç”¨ PowerShell æª¢æŸ¥**
```powershell
# æª¢æŸ¥æ‡‰ç”¨æ˜¯å¦å·²å®‰è£
Get-AppxPackage | Where-Object {$_.Name -like '*AIDevGallery*'} | Format-List Name, Version, PackageFamilyName

# æ‡‰è©²çœ‹åˆ°é¡ä¼¼è¼¸å‡ºï¼š
# Name              : e7af07c0-77d2-43e5-ab82-9cdb9daa11b3
# Version           : 0.0.3.0
# PackageFamilyName : e7af07c0-77d2-43e5-ab82-9cdb9daa11b3_...
```

### âš ï¸ ç‚ºä»€éº¼éœ€è¦ MSIX éƒ¨ç½²ï¼Ÿ

WinUI3 æ‡‰ç”¨ç„¡æ³•ç›´æ¥é‹è¡Œ .exe æ–‡ä»¶ï¼Œæœƒå ±éŒ¯ï¼š
```
System.Runtime.InteropServices.COMException (0x80040154): Class not registered
```

é€™æ˜¯å› ç‚ºï¼š
- Windows App SDK é‹è¡Œæ™‚éœ€è¦æ­£ç¢ºè¨»å†Š
- `Application.Start()` éœ€è¦ COM çµ„ä»¶
- å¿…é ˆé€šé MSIX åŒ…å®‰è£é€™äº›ä¾è³´

**è©³ç´°èªªæ˜è«‹åƒé–±ï¼š[MSIX_DEPLOYMENT_REQUIRED.md](MSIX_DEPLOYMENT_REQUIRED.md)**

### æ­¥é©Ÿ 2: é‹è¡Œæ¸¬è©¦

éƒ¨ç½² MSIX åŒ…å¾Œï¼Œå°±å¯ä»¥é‹è¡Œæ¸¬è©¦äº†ã€‚

**æ–¹æ³• Aï¼šä½¿ç”¨ Visual Studio 2022 Test Explorerï¼ˆæ¨è–¦ï¼‰**

1. åœ¨ Visual Studio ä¸­ï¼Œæ‰“é–‹ **æ¸¬è©¦ï¼ˆTestï¼‰** â†’ **æ¸¬è©¦è³‡æºç®¡ç†å™¨ï¼ˆTest Explorerï¼‰**
   - å¿«æ·éµï¼š`Ctrl+E, T`

2. ç¢ºä¿æ¸¬è©¦å·²è¢«ç™¼ç¾
   - å¦‚æœçœ‹ä¸åˆ°æ¸¬è©¦ï¼Œé»æ“Š **"é‡æ–°æ•´ç†"** æŒ‰éˆ•
   - æˆ–è€…é‡æ–°ç”Ÿæˆè§£æ±ºæ–¹æ¡ˆ

3. ç¯©é¸ UI æ¸¬è©¦
   - åœ¨æœç´¢æ¡†è¼¸å…¥ï¼š`TestCategory=Smoke`ï¼ˆå¿«é€Ÿç…™éœ§æ¸¬è©¦ï¼‰
   - æˆ–è¼¸å…¥ï¼š`TestCategory=UI`ï¼ˆæ‰€æœ‰ UI æ¸¬è©¦ï¼‰
   - æˆ–è¼¸å…¥ï¼š`MainWindowTests`ï¼ˆç‰¹å®šæ¸¬è©¦é¡ï¼‰

4. é‹è¡Œæ¸¬è©¦
   - é»æ“Šé ‚éƒ¨çš„ **"å…¨éƒ¨é‹è¡Œ"** æŒ‰éˆ•
   - æˆ–å³éµé»æ“Šç‰¹å®šæ¸¬è©¦ â†’ **é‹è¡Œ**

5. æŸ¥çœ‹çµæœ
   - ç¶ è‰² âœ… = é€šé
   - ç´…è‰² âŒ = å¤±æ•—ï¼ˆå¯ä»¥æŸ¥çœ‹è©³ç´°éŒ¯èª¤ä¿¡æ¯ï¼‰

![Test Explorer ç¤ºä¾‹](https://user-images.githubusercontent.com/placeholder-test-explorer.png)

**æ–¹æ³• Bï¼šä½¿ç”¨å‘½ä»¤è¡Œ**

```powershell
# é‹è¡Œç…™éœ§æ¸¬è©¦ï¼ˆå¿«é€Ÿé©—è­‰ï¼‰
dotnet test --filter "TestCategory=Smoke"

# é‹è¡Œæ‰€æœ‰ UI æ¸¬è©¦
dotnet test --filter "TestCategory=UI"

# é‹è¡Œç‰¹å®šæ¸¬è©¦é¡
dotnet test --filter "FullyQualifiedName~MainWindowTests"

# é‹è¡Œç¤ºä¾‹æ¸¬è©¦ï¼ˆå­¸ç¿’ç”¨ï¼‰
dotnet test --filter "TestCategory=Sample"
```

**æ¸¬è©¦å·¥ä½œåŸç†ï¼š**
1. âœ… æ¸¬è©¦æœƒè‡ªå‹•æª¢æ¸¬å·²å®‰è£çš„ MSIX åŒ…
2. âœ… ä½¿ç”¨åŒ…æ—åç¨±ï¼ˆPackageFamilyNameï¼‰å•Ÿå‹•æ‡‰ç”¨
3. âœ… ç„¡éœ€æ‰‹å‹•è™•ç† COM è¨»å†Š
4. âœ… æ¸¬è©¦çµæŸå¾Œè‡ªå‹•æ¸…ç†

---

## Visual Studio 2022 æ•…éšœæ’é™¤

### âŒ å•é¡Œï¼šTest Explorer ä¸­çœ‹ä¸åˆ°æ¸¬è©¦

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. **é‡æ–°ç”Ÿæˆè§£æ±ºæ–¹æ¡ˆ**
   - é ‚éƒ¨èœå–®ï¼šç”Ÿæˆ â†’ é‡æ–°ç”Ÿæˆè§£æ±ºæ–¹æ¡ˆ
   - å¿«æ·éµï¼š`Ctrl+Shift+B`

2. **æ¸…ç†ä¸¦é‡æ–°ç”Ÿæˆ**
   ```
   ç”Ÿæˆ â†’ æ¸…ç†è§£æ±ºæ–¹æ¡ˆ
   ç”Ÿæˆ â†’ é‡æ–°ç”Ÿæˆè§£æ±ºæ–¹æ¡ˆ
   ```

3. **æª¢æŸ¥ Test Explorer è¨­ç½®**
   - é»æ“Š Test Explorer å·¥å…·æ¬„çš„è¨­ç½®åœ–æ¨™
   - ç¢ºä¿ "åœ¨ç”Ÿæˆå¾Œè‡ªå‹•é‹è¡Œæ¸¬è©¦" å·²å•Ÿç”¨

4. **æ‰‹å‹•é‡æ–°æ•´ç†**
   - åœ¨ Test Explorer ä¸­é»æ“Š "é‡æ–°æ•´ç†" æŒ‰éˆ•

### âŒ å•é¡Œï¼šéƒ¨ç½²å¤±æ•—ï¼ˆå³éµèœå–®æ²’æœ‰ "éƒ¨ç½²" é¸é …ï¼‰

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. **æª¢æŸ¥é …ç›®é¡å‹**
   - ç¢ºä¿ `AIDevGallery` æ˜¯ WinUI3/MSIX é …ç›®
   - æŸ¥çœ‹é …ç›®å±¬æ€§ä¸­æ˜¯å¦æœ‰ "æ‰“åŒ…" ç›¸é—œè¨­ç½®

2. **ä½¿ç”¨ F5 ä»£æ›¿**
   - ç›´æ¥æŒ‰ F5 é‹è¡Œæœƒè‡ªå‹•éƒ¨ç½²
   - æˆ–ä½¿ç”¨ï¼šç”Ÿæˆ â†’ éƒ¨ç½²è§£æ±ºæ–¹æ¡ˆ

3. **æª¢æŸ¥å¹³å°é…ç½®**
   - ç¢ºä¿é¸æ“‡äº† `x64` å¹³å°ï¼ˆä¸æ˜¯ Any CPUï¼‰
   - åœ¨å·¥å…·æ¬„çš„ä¸‹æ‹‰èœå–®ä¸­é¸æ“‡

### âŒ å•é¡Œï¼šæ¸¬è©¦é‹è¡Œæ™‚å ± COM éŒ¯èª¤

**éŒ¯èª¤ä¿¡æ¯ï¼š**
```
System.Runtime.InteropServices.COMException (0x80040154): Class not registered
```

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. **ç¢ºèªå·²éƒ¨ç½² MSIX**
   - æŒ‰ Windows éµï¼Œæœç´¢ "AI Dev Gallery Dev"
   - å¦‚æœæ‰¾ä¸åˆ°ï¼Œèªªæ˜æ²’æœ‰éƒ¨ç½²æˆåŠŸ

2. **é‡æ–°éƒ¨ç½²**
   - åœ¨ VS ä¸­æŒ‰ F5 é‹è¡Œä¸€æ¬¡æ‡‰ç”¨
   - æˆ–å³éµé»æ“Šé …ç›® â†’ éƒ¨ç½²

3. **å¸è¼‰èˆŠç‰ˆæœ¬å¾Œé‡è©¦**
   ```powershell
   Get-AppxPackage | Where-Object {$_.Name -like '*AIDevGallery*'} | Remove-AppxPackage
   ```
   ç„¶å¾Œåœ¨ VS ä¸­é‡æ–°éƒ¨ç½²

### âŒ å•é¡Œï¼šæ¸¬è©¦è¶…æ™‚

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. **é—œé–‰å…¶ä»–é‹è¡Œä¸­çš„å¯¦ä¾‹**
   - é—œé–‰å¾é–‹å§‹èœå–®æ‰“é–‹çš„æ‡‰ç”¨å¯¦ä¾‹
   - æˆ–åœ¨ä»»å‹™ç®¡ç†å™¨ä¸­çµæŸ AIDevGallery é€²ç¨‹

2. **å¢åŠ è¶…æ™‚æ™‚é–“**
   - é¦–æ¬¡é‹è¡Œå¯èƒ½éœ€è¦æ›´é•·æ™‚é–“
   - ç­‰å¾… 60 ç§’å·¦å³

3. **æª¢æŸ¥ç³»çµ±è³‡æº**
   - ç¢ºä¿æœ‰è¶³å¤ çš„å…§å­˜å’Œ CPU
   - é—œé–‰ä¸å¿…è¦çš„æ‡‰ç”¨ç¨‹åº

### âŒ å•é¡Œï¼šF5 é‹è¡Œå¤±æ•—

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. **æª¢æŸ¥å•Ÿå‹•é …ç›®**
   - åœ¨è§£æ±ºæ–¹æ¡ˆè³‡æºç®¡ç†å™¨ä¸­
   - å³éµé»æ“Š `AIDevGallery` é …ç›®
   - é¸æ“‡ "è¨­ç‚ºå•Ÿå‹•é …ç›®"

2. **æª¢æŸ¥é…ç½®**
   - é…ç½®ï¼šDebugï¼ˆä¸æ˜¯ Releaseï¼‰
   - å¹³å°ï¼šx64ï¼ˆä¸æ˜¯ Any CPU æˆ– ARM64ï¼Œé™¤éæ‚¨ä½¿ç”¨ ARM è¨­å‚™ï¼‰

3. **æ¸…ç†ä¸¦é‡æ–°ç”Ÿæˆ**
   ```
   ç”Ÿæˆ â†’ æ¸…ç†è§£æ±ºæ–¹æ¡ˆ
   ç”Ÿæˆ â†’ é‡æ–°ç”Ÿæˆè§£æ±ºæ–¹æ¡ˆ
   ```

### ğŸ’¡ æç¤ºï¼šä½¿ç”¨ VS è¼¸å‡ºçª—å£èª¿è©¦

1. **æŸ¥çœ‹éƒ¨ç½²æ—¥èªŒ**
   - è¦–åœ– â†’ è¼¸å‡ºï¼ˆæˆ– `Ctrl+W, O`ï¼‰
   - åœ¨ "é¡¯ç¤ºè¼¸å‡ºä¾†æº" ä¸‹æ‹‰èœå–®ä¸­é¸æ“‡ "ç”Ÿæˆ"
   - æŸ¥çœ‹éƒ¨ç½²éç¨‹çš„è©³ç´°ä¿¡æ¯

2. **æŸ¥çœ‹æ¸¬è©¦æ—¥èªŒ**
   - åœ¨ "é¡¯ç¤ºè¼¸å‡ºä¾†æº" ä¸­é¸æ“‡ "æ¸¬è©¦"
   - å¯ä»¥çœ‹åˆ°æ¸¬è©¦é‹è¡Œæ™‚çš„ Console.WriteLine è¼¸å‡º

### æ­¥é©Ÿ 3: æŸ¥çœ‹çµæœ

æ¸¬è©¦é‹è¡Œå¾Œï¼š
- æ§åˆ¶å°æœƒé¡¯ç¤ºè©³ç´°æ—¥èªŒ
- æˆªåœ–ä¿å­˜åœ¨ `AIDevGallery.UnitTests\bin\x64\Debug\net9.0-windows10.0.26100.0\Screenshots\`

## æ¸¬è©¦ç¤ºä¾‹

### æœ€ç°¡å–®çš„æ¸¬è©¦

```csharp
[TestClass]
public class MyTests : FlaUITestBase
{
    [TestMethod]
    [TestCategory("UI")]
    public void Test_WindowExists()
    {
        // MainWindow å·²è‡ªå‹•åˆå§‹åŒ–
        Assert.IsNotNull(MainWindow);
        Assert.IsFalse(string.IsNullOrEmpty(MainWindow.Title));
    }
}
```

### æŸ¥æ‰¾ä¸¦é»æ“ŠæŒ‰éˆ•

```csharp
[TestMethod]
[TestCategory("UI")]
public void Test_ClickButton()
{
    var button = MainWindow.FindFirstDescendant(
        cf => cf.ByAutomationId("MyButton"));
    
    Assert.IsNotNull(button, "Button should exist");
    button.Click();
    
    TakeScreenshot("After_Button_Click");
}
```

## é©—è­‰å®‰è£

é‹è¡Œä»¥ä¸‹å‘½ä»¤é©—è­‰ FlaUI å·²æ­£ç¢ºå®‰è£ï¼š

```powershell
# æª¢æŸ¥åŒ…å¼•ç”¨
dotnet list AIDevGallery.UnitTests\AIDevGallery.UnitTests.csproj package

# æ‡‰è©²çœ‹åˆ°ï¼š
# FlaUI.UIA3     5.0.0
```

## ä¸‹ä¸€æ­¥

### ç·¨å¯«è‡ªå®šç¾©æ¸¬è©¦

1. åœ¨ `AIDevGallery.UnitTests\UITests\` å‰µå»ºæ–°æ¸¬è©¦é¡
2. ç¹¼æ‰¿ `FlaUITestBase`
3. ä½¿ç”¨ Inspect.exe æŸ¥æ‰¾å…ƒç´ çš„ AutomationId
4. åƒè€ƒ `BasicInteractionTests.cs` ä¸­çš„ç¤ºä¾‹

### èª¿è©¦æ¸¬è©¦

1. **ä½¿ç”¨ Inspect.exe** æŸ¥çœ‹ UI å…ƒç´ å±¬æ€§
   - ä½ç½®: `C:\Program Files (x86)\Windows Kits\10\bin\[version]\x64\inspect.exe`
   
2. **æ·»åŠ æ–·é»** åœ¨ Visual Studio ä¸­èª¿è©¦
   
3. **æŸ¥çœ‹æˆªåœ–** åœ¨å¤±æ•—æ™‚è‡ªå‹•ä¿å­˜

4. **é–±è®€æ—¥èªŒ** æ§åˆ¶å°è¼¸å‡ºåŒ…å«è©³ç´°ä¿¡æ¯

## å¸¸è¦‹å•é¡Œ

### â“ æ¸¬è©¦æ‰¾ä¸åˆ°æ‡‰ç”¨ç¨‹åºï¼Ÿ

**è§£æ±ºæ–¹æ¡ˆ**: ç¢ºä¿å·²æ§‹å»ºæ‡‰ç”¨ç¨‹åº
```powershell
dotnet build -c Debug /p:Platform=x64
```

### â“ æ¸¬è©¦è¶…æ™‚ï¼Ÿ

**è§£æ±ºæ–¹æ¡ˆ**: åœ¨ `FlaUITestBase.TestInitialize()` ä¸­å¢åŠ è¶…æ™‚æ™‚é–“

### â“ æ‰¾ä¸åˆ°ç‰¹å®šå…ƒç´ ï¼Ÿ

**è§£æ±ºæ–¹æ¡ˆ**: 
1. ä½¿ç”¨ Inspect.exe ç¢ºèª AutomationId
2. æ·»åŠ ç­‰å¾…æ™‚é–“
3. æª¢æŸ¥å…ƒç´ æ˜¯å¦åœ¨è¦–åœ–ä¸­

## æŠ€è¡“ç´°ç¯€

### ç‚ºä»€éº¼é¸æ“‡ FlaUI 5.0.0ï¼Ÿ

- âœ… æ”¯æŒ .NET 9.0
- âœ… åŸç”Ÿæ”¯æŒ WinUI3
- âœ… æ¯” WinAppDriver å¿« 5-10 å€
- âœ… ä¸éœ€è¦é¡å¤–çš„æœå‹™å™¨é€²ç¨‹
- âœ… æ´»èºç¶­è­·å’Œç¤¾å€æ”¯æŒ

### FlaUI vs WinAppDriver

| ç‰¹æ€§ | FlaUI | WinAppDriver |
|------|-------|--------------|
| æ€§èƒ½ | âš¡ å¿« | ğŸ¢ æ…¢ |
| ç¶­è­·ç‹€æ…‹ | âœ… æ´»èº | âŒ å·²æ­¸æª” |
| é…ç½®è¤‡é›œåº¦ | âœ… ç°¡å–® | âš ï¸ è¤‡é›œ |
| WinUI3 æ”¯æŒ | âœ… å®Œæ•´ | âš ï¸ æœ‰é™ |

è©³ç´°å°æ¯”è¦‹: [UI-Testing-Technology-Comparison.md](../docs/UI-Testing-Technology-Comparison.md)

## è³‡æºéˆæ¥

- **FlaUI GitHub**: https://github.com/FlaUI/FlaUI
- **FlaUI æ–‡æª”**: https://github.com/FlaUI/FlaUI/wiki
- **UI Automation æ–‡æª”**: https://learn.microsoft.com/en-us/windows/win32/winauto/entry-uiauto-win32
- **æ¸¬è©¦æŒ‡å—**: [UITests/README.md](../AIDevGallery.UnitTests/UITests/README.md)

## è²¢ç»

æ­¡è¿æäº¤æ–°çš„æ¸¬è©¦ç”¨ä¾‹æˆ–æ”¹é€²ç¾æœ‰æ¸¬è©¦ï¼è«‹éµå¾ªï¼š

1. ç¹¼æ‰¿ `FlaUITestBase`
2. æ·»åŠ  `[TestCategory("UI")]` å±¬æ€§
3. ç·¨å¯«æ¸…æ™°çš„æ¸¬è©¦æè¿°
4. åŒ…å«é©ç•¶çš„æ–·è¨€å’Œæ—¥èªŒ
5. æ¸¬è©¦å¤±æ•—æ™‚ä¿å­˜æˆªåœ–

---

**æ–‡æª”ç‰ˆæœ¬**: 1.0  
**å‰µå»ºæ—¥æœŸ**: 2025-11-25  
**FlaUI ç‰ˆæœ¬**: 5.0.0  
**ç¶­è­·è€…**: é–‹ç™¼åœ˜éšŠ
